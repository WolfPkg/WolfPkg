#!/usr/bin/env php
<?php
declare(strict_types=1);

require_once __DIR__.'/../lib/autoconf.php';

if (posix_geteuid() !== 0) {
	echo "This must be run as root or with sudo!\n";
	exit(1);
}

@mkdir("{$_ENV['WOLFPKG_ROOT']}/setuid", 0710, true);
\E\chgrp("{$_ENV['WOLFPKG_ROOT']}/setuid", $_ENV['WOLFPKG_HOST_GROUP']);

\E\chdir($_ENV['WOLFPKG_ROOT'].'/docker');
$df = \Utils\configure_file_tmp('Dockerfile.ubuntu-tools');
\Utils\ppassthru('cat '.escapeshellarg($df).' | docker build --squash -t wolfpkg/ubuntu-tools -');
$df = \Utils\configure_file_tmp('Dockerfile.debian-tools');
\Utils\ppassthru('cat '.escapeshellarg($df).' | docker build --squash -t wolfpkg/debian-tools -');
